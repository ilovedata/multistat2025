[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "다변량통계학-2025년 2학기",
    "section": "",
    "text": "Preface\n이 책은 2025년 다변량통계학에 대한 온라인 교재입니다.\n\n\n\n\n\n\n표기법\n\n\n\n이 책에서 사용된 기호, 표기법, 프로그램의 규칙과 쓰임은 다음과 같습니다.\n\n스칼라(scalar)와 일변량 확률변수는 일반적으로 보통 글씨체의 소문자로 표기한다. 특별한 이유가 있는 경우 대문자로 표시할 것이다.\n벡터, 행렬, 다변량 확률벡터는 굵은 글씨체로 표기한다.\n통계 프로그램은 R을 이용하였다. 각 예제에 사용된 R 프로그램은 코드 상자를 열면 나타난다.",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "qmd/multivar-dist.html",
    "href": "qmd/multivar-dist.html",
    "title": "1  확률벡터와 다변량 정규분포",
    "section": "",
    "text": "1.1 예제- 국민체력100\n다변량 자료(multivariate data)는 두 개 이상의 변수를 측정한 자료를 말합니다. 예를 들어, 학생들의 키와 몸무게, 시험 점수와 공부 시간, 나이와 소득 등이 다변량 자료에 해당합니다. 다변량 자료는 변수들 간의 관계를 분석하고 이해하는 데 중요한 역할을 합니다. 다변량 자료를 효과적으로 표현하고 분석하기 위해 다양한 그래프와 통계 기법이 사용됩니다. 이 장에서는 다변량 자료의 표현 방법과 분포를 이해하는 데 필요한 기본 개념과 도구들을 소개합니다.\n국민체력100은 국민의 체력증진과 건강증진을 위해 개발된 종합적인 체력측정 프로그램이다. 이 프로그램은 다양한 연령대와 성별에 맞춘 체력측정 항목을 포함하고 있으며, 이를 통해 개인의 체력 상태를 평가하고 개선할 수 있는 기회를 제공한다.\n이번 장에서는 청소년(13-18세) 남여 3000명에 대하여 2024년에 국민체력100 사업에서 측정한 자료를 예제로 사용하여 다변량 자료를 표현하는 방법들과 분포를 배울것이다.\n먼저 측정항목에 대한 설명에 대한 자료를 보자.\nload(here(\"data\", \"physical100.RData\"))\nls()\n\n[1] \"physical100_df\"      \"physical100_df_info\"\n먼저 데이터프레임 selected_var_df 에는 측정한 항목의 영문 변수이름(varname_eng), 종목의 설명(varname_kor), 측정분야(category_kor) 그리고 측정단위(unit) 가 다음과 같이 저장되어 있다.\nvarname_engvarname_korcategory_korunitheight신장신체구성cmweight체중신체구성kgbody_fat_pct체지방율신체구성grip_left악력_좌근력kggrip_right악력_우근력kgsit_forward앉아윗몸앞으로굽히기유연성cmillinois일리노이민첩성초hang_time청소년체공시간순발력초twall_timeTWALL_시간협응력초twall_errorsTWALL_실수협응력회twall_scoreTWALL_결과값협응력초bmiBMI신체구성rel_grip상대악력근력%abs_grip절대악력근력kg\n다음으로 청소년 3000명의 측정 자료의 일부는 다음과 같다.\nsexageheightweightbody_fat_pctgrip_leftsit_forward남성15166.568.026.331.922.1여성13166.445.522.020.010.2남성13163.244.711.722.0-2.0여성14156.944.726.917.3-5.0남성17175.778.116.752.218.5여성16167.274.537.125.912.0여성16162.057.337.121.6-4.5여성17169.175.039.821.60.1여성15160.956.833.125.1-8.0남성13162.857.618.039.628.0",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>확률벡터와 다변량 정규분포</span>"
    ]
  },
  {
    "objectID": "qmd/multivar-dist.html#확률벡터와-기본-성질",
    "href": "qmd/multivar-dist.html#확률벡터와-기본-성질",
    "title": "1  확률벡터와 다변량 정규분포",
    "section": "1.2 확률벡터와 기본 성질",
    "text": "1.2 확률벡터와 기본 성질\n\n1.2.1 일변량 확률변수\n일변량 확률변수(random variable) \\(X\\)가 확률밀도함수 \\(f(x)\\)를 가지는 분포를 따를때 기대값과 분산은 다음과 같이 정의된다.\n\\[\n\\begin{aligned}\nE(X) & = \\int x f(x)  dx = \\mu\\\\\nV(X) & = E[ X-E(X)]^2=\\int (x-\\mu)^2 f(x) dx =\\sigma^2\n\\end{aligned}\n\\]\n새로운 확률변수 \\(Y\\)가 확률변수 \\(X\\)의 다음과 같은 선형변환으로 표시된다면 (\\(a\\)와 \\(b\\)는 실수)\n\\[ Y = aX+b \\]\n일변량 확률변수 \\(X\\)의 기대값(평균)과 분산은 다음과 같이 계산된다.\n\\[\n\\begin{aligned}\nE(Y) & = E(aX+b) \\\\\n& = \\int (ax+b) f(x) dx \\\\\n& = a \\int x f(x) dx + b \\\\\n& = a E(X) + b\\\\\n& = a \\mu + b\n\\end{aligned}\n\\]\n\\[\n\\begin{aligned}\nV(Y) & = Var(aX+b) \\\\\n& = E[aX+b -E(aX+b)]^2 \\\\\n& = E[a(X-\\mu)]^2 \\\\\n& = a^2 E(X-\\mu)^2\\\\\n& = a^2 \\sigma^2\n\\end{aligned}\n\\]\n\n\n1.2.2 다변량 확률벡터\n이제 하나의 학률변수가 아는 2개 이상의 확률변수들을 모아놓은 확률벡터(random vector)를 생각해 보자. 다음과 같이 벡터로 표현된 확률벡터 \\(\\pmb X\\)가 \\(p\\) 차원의 다변량 분포(multivariate distribution)를 따른다고 하고 결합확률밀도함수 \\(f(\\pmb x) =f(x_1,x_2,\\dots,x_p)\\)를 를 가진다고 하자.\n\\[\n\\pmb X =\n  \\begin{bmatrix}\nX_1 \\\\\nX_2 \\\\\nX_3 \\\\\n..  \\\\\nX_p\n\\end{bmatrix}\n\\]\n다변량 확률벡터의 평균 벡터(mean vector)는 다음과 같이 주어진다. 확률벡터의 평균 벡터는 구성하는 각 확률변수의 평균으로 주어진다.\n\\[\n\\pmb E(\\pmb X) =\n  \\begin{bmatrix}\nE(X_1) \\\\\nE(X_2) \\\\\nE(X_3) \\\\\n..  \\\\\nE(X_p)\n\\end{bmatrix}\n=\n  \\begin{bmatrix}\n\\mu_1 \\\\\n\\mu_2 \\\\\n..  \\\\\n\\mu_p\n\\end{bmatrix}\n=\\pmb \\mu\n\\]\n다음으로 공분산(covariance)과 상관계수(correlation coefficient)에 대해서 알아보자. 우리는 여러 개의 확률 변수의 관계를 분석하는 분석을 하려고 하는데, 이 경우 가장 많이 사용되는 통계량이 두 개의 변수들의 선형적 관계를 나타내는 상관계수이다. 두 확률변수 \\(X_k\\) 와 \\(X_l\\) 의 상관계수 \\(\\rho_{jk}\\) 는 다음과 같이 정의된다.\n\\[\n\\rho_{jk} = \\frac{Cov(X_j, X_k)}{ \\sqrt{V(X_j) V(X_k)}} = \\frac{\\sigma_{jk}}{\\sqrt{\\sigma_{jj}\n  \\sigma_{kk}}}, \\quad j,k=1,2,\\dots,p\n\\]\n위의 상관계수의 공식에서 \\(\\sigma_{jj} \\equiv \\sigma^2_j\\) 와 \\(\\sigma_{kk} = \\sigma^2_k\\) 는 각각 확률변수 \\(X_i\\) 와 \\(X_j\\) 의 분산이며, 공분산은 다음과 같이 정의된다.\n\\[\n\\begin{aligned}\nCov(X_j, X_k) & = E [(X_j - E(X_j))(X_k - E(X_k))] \\\\\n& = E(X_j  X_k) - E(X_j)E(X_k)\n\\end{aligned}\n\\]\n위의 식을 보면 각각의 확률 변수가 평균에서 차이가 나는 두 개의 편차, 즉 \\(X_j - E(X_j)\\), \\(X_k - E(X_k)\\) 의 곱에 대한 기대값으로 두 확률 변수가 평균에서 얼마나 같은 방향 또는 반대 방향으로 함께 움직이는 경향이 있는지 그 정도를 수치화한 값이다. 두 확률변수의 공분산의 값이 양의 값으로 커지면 두 확률 변수의 변화가 같은 방향으로 나타난다는 의미이며, 반대로 음의 값으로 커지면 두 확률 변수의 변화가 반대 방향으로 나타난다는 의미이다.\n참고로 공분산은 단위가 확률 변수의 단위에 영향을 받기 떄문에 크기 자체만으로 비교가 직관적이지 않다는 단점이 있다. 반면에 상관 계수는 공분산을 각 확률 변수의 표분편차로 나누어 얻은 값이므로 단위에 영향을 받지 않아서 상대적인 비교가 가능하다.\n상관계수는 -1 과 1 사이의 값을 가지며 1에 가까울수록 두 개의 변수가 같은 방향으로 움직이는 확률적 경향이 강해지며 반대로 -1 에 가까워질수록 반대의 방향을 움직이는 경향이 강해진다.\n여기서 중요한 점은 상관계수(또는 공분산)은 두 확률 변수의 선형적 관계(linear relationship)을 나타내는 통계량으로 비선형적 관계를 파악하는데는 한계가 있을 수 있다.\n이제 확률 벡터의 모든 변수에 대한 분산과 공분산을 다음과 같은 공분산 행렬로 나타낼 수 있다.\n\\[\n\\begin{aligned}\nV(\\pmb X) & = Cov(\\pmb X) = E (\\pmb X-\\pmb \\mu) (\\pmb X-\\pmb \\mu)^t \\\\\n& = E(\\pmb X \\pmb X^t)-\\pmb \\mu \\pmb  \\mu^t\\\\\n& =\n  \\begin{bmatrix}\n\\sigma_{11} & \\sigma_{12} & \\dots & \\sigma_{1p} \\\\\n\\sigma_{12} & \\sigma_{22} & \\dots & \\sigma_{2p} \\\\\n& \\dots & \\dots & \\\\\n\\sigma_{1p} & \\sigma_{2p} & \\dots & \\sigma_{pp} \\\\\n\\end{bmatrix} \\\\\n& = \\pmb \\Sigma\n\\end{aligned}\n\\]\n여기서 \\(\\sigma_{jj}=V(X_j)\\), \\(\\sigma_{jk} = Cov(X_j, X_k)=Cov(X_k, X_j)\\) 이다. 따라서 공분산 행렬 \\(\\pmb \\Sigma\\)는 대칭행렬(symmetric matrix)이다.\n더 나아가 확률 벡터의 모든 변수에 대한 상관계수을 다음과 같은 상관계수 행렬(correlation matrix) \\(\\pmb R\\) 로 나타낼 수 있다.\n\\[\n\\begin{aligned}\ncor(\\pmb X) & =\n  \\begin{bmatrix}\n1 & \\rho_{12} & \\dots & \\rho_{1p} \\\\\n\\rho_{12} & 1 & \\dots & \\rho_{2p} \\\\\n& \\dots & \\dots & \\\\\n\\rho_{1p} & \\rho_{2p} & \\dots & 1 \\\\\n\\end{bmatrix} \\\\\n& = \\pmb R\n\\end{aligned}\n\\]\n위의 상관계수 행렬에서 대각원소는 모두 1 임이 유의하자.\n새로운 확률벡터 \\(\\pmb Y\\)가 확률벡터 \\(\\pmb X\\) 의 선형변환라고 하자.\n\\[ \\pmb Y = \\pmb A  \\pmb X + \\pmb b \\]\n단 여기서 \\(\\pmb A\\) 는 \\(p \\times p\\) 실수 행렬이고 \\(\\pmb b\\) 는 \\(p \\times 1\\) 실수 벡터이다.\n확률벡터 \\(\\pmb Y\\)의 기대값(평균벡터)과 공분산은 다음과 같이 계산된다.\n\\[\n\\begin{aligned}\nE(\\pmb Y ) &= E(\\pmb A \\pmb X+ \\pmb b) \\\\\n&= \\pmb A E(\\pmb X)+ \\pmb b \\\\\n&= \\pmb A \\pmb \\mu+ \\pmb b \\\\\nV(\\pmb Y) &= Var(\\pmb A \\pmb X+ \\pmb b) \\\\\n&= E[\\pmb A \\pmb X+ \\pmb b -E(\\pmb A \\pmb X+ \\pmb b)] [\\pmb A \\pmb X+ \\pmb b -E(\\pmb A \\pmb X+ \\pmb b)]^t \\\\\n&= E[\\pmb A \\pmb X -  \\pmb A \\pmb \\mu] [\\pmb A \\pmb X -  \\pmb A \\pmb \\mu]^t \\\\\n&= E[\\pmb A (\\pmb X - \\pmb \\mu)] [\\pmb A (\\pmb X - \\pmb \\mu)]^t \\\\\n&=  E [\\pmb A(\\pmb X - \\pmb \\mu) (\\pmb X - \\pmb \\mu)^t  \\pmb A^t ] \\\\\n&= \\pmb A E [(\\pmb X - \\pmb \\mu) (\\pmb X - \\pmb \\mu)^t] \\pmb A^t \\\\\n&= \\pmb A \\pmb \\Sigma \\pmb A^t\n\\end{aligned}\n\\]\n\n\n1.2.3 표본 통계량\n이제 확률 표본(sample)을 이용하여 평균벡터, 공분산, 상관계수를 추정하는 간단한 방법에 대해서 알아보자.\n확률 벡터 \\(\\pmb X\\) 가 평균이 \\(\\pmb \\mu\\) 이고 공분산이 \\(\\pmb \\Sigma\\) 인 다변량 분포 \\(F\\) 를 따른다고 가정하자. 만약 확률 표본 \\(\\pmb X_1, \\pmb X_2, \\dots, \\pmb X_n\\) 이 독립적으로 다변량 분포 \\(F\\) 에서 임의로 추출되었다면\n\\[\n\\pmb X_i =\n\\begin{bmatrix}\nX_{i1} \\\\\nX_{i2} \\\\\nX_{i3} \\\\\n..  \\\\\nX_{ip}\n\\end{bmatrix}\n\\quad i=1,2,\\dots,n\n\\]\n다음과 같이 표본 통계량을 이용하여 평균벡터, 공분산, 상관계수를 추정할 수 있다.\n먼저 다음과 같은 표본평균 벡터 \\(\\bar {\\pmb X}\\) 는 평균벡터 \\(\\pmb \\mu\\) 의 불편추정량(unbiased estimator)이다.\n\\[\n\\bar {\\pmb X} =\n  \\begin{bmatrix}\n\\bar X_1  \\\\\n\\bar X_2  \\\\\n\\bar X_3  \\\\\n..  \\\\\n\\bar X_p  \\\\\n\\end{bmatrix}\n=\n  \\begin{bmatrix}\n\\sum_{i=1}^n X_{i1} / n  \\\\\n\\sum_{i=1}^n X_{i2} / n \\\\\n\\sum_{i=1}^n X_{i3} / n \\\\\n..  \\\\\n\\sum_{i=1}^n X_{ip} / n\n\\end{bmatrix}\n=\n\\hat {\\pmb \\mu}\n\\]\n여기서 \\(X_{ij}\\) 는 \\(i\\)번째 표본벡터 \\(\\pmb X_i =(X_{i1} X_{i2} \\dots X_{ip})^t\\)의 \\(j\\)번째 확률변수이다.\n또한 아래에 주어진 표본 공분산 행렬 \\(\\pmb S\\) 은 공분산 행렬 \\(\\pmb \\Sigma\\) 의 추정량이다.\n\\[\n\\pmb S\n=\n  \\begin{bmatrix}\ns_{11} & s_{12} & \\dots & s_{1p} \\\\\ns_{12} & s_{22} & \\dots & s_{2p} \\\\\n& \\dots & \\dots & \\\\\ns_{1p} & s_{2p} & \\dots & s_{pp} \\\\\n\\end{bmatrix}\n=\n\\hat {\\pmb \\Sigma}\n\\] 위에서 \\(s_{jj} \\equiv s^2_j\\) 는 확률변수 \\(X_j\\) 의 표본 분산이며 \\(s_{jk}\\) 는 \\(X_j\\) 와 \\(X_k\\) 의 표본 공분산이며 다음과 같이 계산된다.\n\\[\ns_{jj} = \\frac{1}{n-1} \\sum_{i=1}^n (X_{ij} - \\bar X_j)^2, \\quad\ns_{jk} = \\frac{1}{n-1} \\sum_{i=1}^n (X_{ij} - \\bar X_j)(X_{ik} - \\bar X_k), \\quad j,k=1,2,\\dots,p\n\\]\n마지막으로 아래에 주어진 표본 상관계수 행렬 \\(\\pmb R\\) 은 상관계수 행렬 \\(\\pmb R\\) 의 추정량이다.\n\\[\n\\hat {\\pmb R} =\n  \\begin{bmatrix}\n1 & r_{12} & \\dots & r_{1p} \\\\\nr_{12} & 1 & \\dots & r_{2p} \\\\\n& \\dots & \\dots & \\\\\nr_{1p} & r_{2p} & \\dots & 1 \\\\\n\\end{bmatrix}\n\\]\n여기서 \\(r_{jk}\\) 는 확률변수 \\(X_j\\) 와 \\(X_k\\) 의 표본 상관계수이며 다음과 같이 계산된다.\n\\[\nr_{jk} = \\frac{s_{jk}}{\\sqrt{s_{jj} s_{kk}}}, \\quad j,k=1,2,\\dots,p\n\\]\n\n\n1.2.4 예제-국민체력100\n이제 위에서 샇펴본 국민체력100 자료에서 청소년 남자 자료를 이용하여 평균벡터, 공분산 행렬, 상관계수 행렬의 표본 통계량을 계산해 보자.\n먼저 표본 평균 벡터를 계산해 보자. 주어진 변수가 많으니 키(height), 몸무게(weight), 체지방률(body_fat_pct), 악력(grip_left), 앉아윗몸앞으로굽히기(sit_forward), 청소년체공시간(hang_time) 6개 변수만 선택하여 계산해 보자.\n\n# 국민체력100 자료에서 남자만 선택하여 데이터프레임 df 생성\ndf &lt;- physical100_df %&gt;% \n  filter(sex == \"남성\") %&gt;%\n  select(height, weight, body_fat_pct, grip_left, sit_forward,hang_time)\n\n#  패키지 dplyr의 summarise()와 across() 함수를 사용하여 각 열의 평균 계산\nsample_mean_vector &lt;- df %&gt;%\n  summarise(across(everything(), \\(x) mean(x, na.rm = TRUE))) %&gt;%\n  unlist()\n\nsample_mean_vector\n\n      height       weight body_fat_pct    grip_left  sit_forward    hang_time \n 172.0451492   69.7115470   20.9993923   36.0728729    7.8976630    0.5593964 \n\n\n다음으로 표본 공분산 행렬을 계산해 보자.\n\ncor(df)\n\n                    height      weight body_fat_pct   grip_left   sit_forward\nheight        1.0000000000  0.50994161  -0.03019400  0.45225668  0.0008938941\nweight        0.5099416134  1.00000000   0.69156075  0.46152254  0.0111910927\nbody_fat_pct -0.0301940037  0.69156075   1.00000000 -0.01208826 -0.1434596849\ngrip_left     0.4522566754  0.46152254  -0.01208826  1.00000000  0.2605654264\nsit_forward   0.0008938941  0.01119109  -0.14345968  0.26056543  1.0000000000\nhang_time     0.1884978140 -0.14265212  -0.48446817  0.34559521  0.2889235491\n              hang_time\nheight        0.1884978\nweight       -0.1426521\nbody_fat_pct -0.4844682\ngrip_left     0.3455952\nsit_forward   0.2889235\nhang_time     1.0000000\n\n\n마지막으로 표본 상관계수 행렬을 계산해 보자.\n\ncor(df)\n\n                    height      weight body_fat_pct   grip_left   sit_forward\nheight        1.0000000000  0.50994161  -0.03019400  0.45225668  0.0008938941\nweight        0.5099416134  1.00000000   0.69156075  0.46152254  0.0111910927\nbody_fat_pct -0.0301940037  0.69156075   1.00000000 -0.01208826 -0.1434596849\ngrip_left     0.4522566754  0.46152254  -0.01208826  1.00000000  0.2605654264\nsit_forward   0.0008938941  0.01119109  -0.14345968  0.26056543  1.0000000000\nhang_time     0.1884978140 -0.14265212  -0.48446817  0.34559521  0.2889235491\n              hang_time\nheight        0.1884978\nweight       -0.1426521\nbody_fat_pct -0.4844682\ngrip_left     0.3455952\nsit_forward   0.2889235\nhang_time     1.0000000\n\n\n표본 상관계수 행렬을 보면 다양한 상관관계가 나타나는데 이러한 관계를 더 자세하게 보기위하여 산점도 행렬(scatterplot matrix)로 시각화 하면 더 유용한 정보를 얻을 수 있다.\n\npairs(df, pch=19, col='blue', cex=0.1)",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>확률벡터와 다변량 정규분포</span>"
    ]
  },
  {
    "objectID": "qmd/multivar-dist.html#다변량-정규분포",
    "href": "qmd/multivar-dist.html#다변량-정규분포",
    "title": "1  확률벡터와 다변량 정규분포",
    "section": "1.3 다변량 정규분포",
    "text": "1.3 다변량 정규분포\n일변량 확률변수 \\(X\\)가 평균이 \\(\\mu\\) 이고 분산이 \\(\\sigma^2\\)인 정규분포를 따른다면 다음과 같이 나타내고 \\[ X \\sim N(\\mu, \\sigma^2 ) \\] 확률밀도함수 \\(f(x)\\) 는 다음과 같이 주어진다.\n\\[ f(x) = (2 \\pi \\sigma^2)^{-1/2} \\exp \\left ( - \\frac{(x-\\mu)^2}{2} \\right ) \\]\n\n1.3.1 확률 밀도 함수\n\\(p\\)-차원 확률벡터 \\(\\pmb X\\)가 평균이 \\(\\pmb \\mu\\) 이고 공분산이 \\(\\pmb \\Sigma\\)인 다변량 정규분포를 따른다면 다음과 같이 나타내고 \\[ \\pmb X \\sim N_p(\\pmb \\mu, \\pmb \\Sigma ) \\] 확률밀도함수 \\(f(\\pmb x)\\) 는 다음과 갇이 주어진다.\n\\[ f(\\pmb x) = (2 \\pi)^{-p/2} | \\pmb \\Sigma|^{-1/2}\n   \\exp \\left ( - \\frac{(\\pmb x-\\pmb \\mu) \\pmb \\Sigma^{-1}(\\pmb x-\\pmb \\mu)^t}{2} \\right ) \\]\n예를 들어 \\(2\\)-차원 확률벡터 \\(\\pmb X=(X_1, X_2)^t\\)가 평균이 \\(\\pmb \\mu=(\\mu_1,\\mu_2)^t\\) 이고 공분산 \\(\\pmb \\Sigma\\)가 다음과 같이 주어진\n\\[\n\\pmb \\Sigma =\n  \\begin{bmatrix}\n\\sigma_{11} & \\sigma_{12} \\\\\n\\sigma_{12} & \\sigma_{22}\n\\end{bmatrix}\n\\]\n이변량 정규분포를 따른다면 확률밀도함수 \\(f(\\pmb x)\\)에서 \\(\\exp\\)함수의 인자는 다음과 같이 주어진다. \\[\n\\begin{aligned}\n&(\\pmb x-\\pmb \\mu) \\pmb \\Sigma^{-1}(\\pmb x-\\pmb \\mu)^t\n= \\\\\n&-\\frac{1}{2 (1-\\rho^2)}\n\\left [\n  \\left ( \\frac{(x_1-\\mu_1)^2}{\\sigma_{11}} \\right )\n  +\\left ( \\frac{(x_2-\\mu_2)^2}{\\sigma_{22}} \\right )\n  -2 \\rho \\left ( \\frac{(x_1-\\mu_1)}{\\sqrt{\\sigma_{11}}} \\right )\n  \\left ( \\frac{(x_2-\\mu_2)}{\\sqrt{\\sigma_{22}}} \\right )\n  \\right ]\n\\end{aligned}\n\\]\n그리고 \\(p=2\\) 인 경우 확률밀도함수의 상수부분은 다음과 같이 주어진다.\n\\[ (2 \\pi)^{-p/2} | \\pmb \\Sigma|^{-1/2} = \\frac{1}{ 2 \\pi \\sqrt{\\sigma_{11} \\sigma_{22} (1-\\rho^2)}} \\]\n여기서 \\(\\rho = \\sigma_{12} / \\sqrt{\\sigma_{11} \\sigma_{22}}\\)\n\n\n\n\n\n\n다변량 정규분포에서 독립과 공분산\n\n\n\n다변량 정규분포에서 공분산이 0인 두 확률 변수는 독립이다. \\[ \\sigma_{ij} = 0 \\leftrightarrow X_i \\text{ and } X_j \\text{ are independent} \\]\n참고로 정규분포가 아닌 다른 분포의 경우 공분산이 0인 두 확률 변수는 독립이 아닐 수 있다.\n\n\n\n\n1.3.2 예제-국민체력100\n이제 위에서 샇펴본 국민체력100 자료에서 청소년 남자의 키(height)와 몸무게(weight) 가 이변량 정규분포를 따른다고 가정하고 확률밀도 함수를 그려보자.\n\n# 필요한 패키지 로드\nlibrary(mvtnorm)\nlibrary(plotly)\n\n# 국민체력100 자료에서 남자만 선택하여 데이터프레임 df 생성, 키와 몸무게 변수만 선택와\ndf &lt;- physical100_df %&gt;% \n  filter(sex == \"남성\") %&gt;%\n  select(height, weight)\n\n#  패키지 dplyr의 summarise()와 across() 함수를 사용하여 각 열의 평균 계산\nsample_mean_vector &lt;- df %&gt;%\n  summarise(across(everything(), \\(x) mean(x, na.rm = TRUE))) %&gt;%\n  unlist()\nsample_mean_vector\n\n   height    weight \n172.04515  69.71155 \n\n# 표본 공분산 행렬 계산\nsample_cov_matrix &lt;- cov(df, use = \"complete.obs\")\nsample_cov_matrix\n\n         height    weight\nheight 47.51166  54.80339\nweight 54.80339 243.09372\n\n# 이변량 정규분포의 확률밀도함수 계산\n# 키와 몸무게의 평균에서 표분편차 3배의 범위의 값을 100개로 나누어 x,y 축 생성\nx1_seq &lt;- seq(sample_mean_vector[1]-3* sqrt(sample_cov_matrix[1,1]), sample_mean_vector[1]+3* sqrt(sample_cov_matrix[1,1]), length.out = 100)\nx2_seq &lt;- seq(sample_mean_vector[2]-3* sqrt(sample_cov_matrix[2,2]), sample_mean_vector[2]+3* sqrt(sample_cov_matrix[2,2]), length.out = 100)\ngrid &lt;- expand.grid(height = x1_seq, weight = x2_seq)\n\n# 확률밀도함수 계산 (z축의 값)\ngrid$z &lt;- dmvnorm(grid, mean = sample_mean_vector, sigma = sample_cov_matrix)\n\n# z를 행렬로 변환 (surface plot용)\nz_matrix &lt;- matrix(grid$z, nrow = length(x1_seq), ncol = length(x2_seq))\n\n다음은 위에서 얻어진 확률밀도 함수를 3차원 surface plot으로 나타낸 것이다.\n\n# 이변량 정규분포의 확률밀도 함를 3D Surface Plot\nplot_ly(\n  x = x1_seq, \n  y = x2_seq, \n  z = z_matrix\n) %&gt;% add_surface() %&gt;%\n  layout(\n    title = \"Bivariate Normal PDF (Surface)\",\n    scene = list(\n      xaxis = list(title = \"키\"),\n      yaxis = list(title = \"몸무게\"),\n      zaxis = list(title = \"Density\")\n    )\n  )\n\n\n\n\n\n아래 그림은 표본으로 부터 얻어진 확률밀도 함수를 2차원 등고선(contour)으로 나타낸 그림이다.\n\nplot_ly(\n  x = x1_seq,\n  y = x2_seq,\n  z = z_matrix\n) %&gt;%\n  add_contour(\n    contours = list(\n      coloring = \"heatmap\",\n      showlabels = TRUE\n    )\n  ) %&gt;%\n  layout(\n    title = \"Bivariate Normal PDF (Contour)\",\n    xaxis = list(title = \"키\"),\n    yaxis = list(title = \"몸무게\")\n  )\n\n\n\n\n\n\n\n1.3.3 조건부 분포\n다변량 정규분포 \\(N(\\pmb \\mu, \\pmb \\Sigma)\\)를 따르는 확률벡터 \\(\\pmb X\\)를 다음과 같이 두 부분으로 나누면\n\\[\n  \\pmb X =\n    \\begin{bmatrix}\n  \\pmb X_1 \\\\\n  \\pmb X_2\n  \\end{bmatrix}, \\quad\n  \\pmb X_1 =\n    \\begin{bmatrix}\n  \\pmb X_{11} \\\\\n  \\pmb X_{12} \\\\\n  \\pmb \\vdots \\\\\n  \\pmb X_{1p}\n  \\end{bmatrix}, \\quad\n  \\pmb X_2=\n    \\begin{bmatrix}\n  \\pmb X_{21} \\\\\n  \\pmb X_{22} \\\\\n  \\pmb \\vdots \\\\\n  \\pmb X_{2q}\n  \\end{bmatrix}\n  \\]\n각각 다변량 정규분포를 따르고 다음과 같이 나타낼 수 있다.\n\\[\n  \\begin{bmatrix}\n  E(\\pmb X_1) \\\\\n  E(\\pmb X_2)\n  \\end{bmatrix}\n  =\n    \\begin{bmatrix}\n  \\pmb \\mu_1 \\\\\n  \\pmb \\mu_2\n  \\end{bmatrix}\n  , \\quad\n  \\begin{bmatrix}\n  V(\\pmb X_1) & Cov(\\pmb X_1, X_2) \\\\\n  Cov(\\pmb X_2 X_1) & V(\\pmb X_2)\n  \\end{bmatrix}\n  =\n    \\begin{bmatrix}\n  \\pmb \\Sigma_{11} & \\pmb \\Sigma_{12} \\\\\n  \\pmb \\Sigma^t_{12} & \\pmb \\Sigma_{22}\n  \\end{bmatrix}\n  \\]\n\\[  \\pmb X =\n    \\begin{bmatrix}\n  \\pmb X_1 \\\\\n  \\pmb X_2\n  \\end{bmatrix}\n  \\sim\n  N_{p+q} \\left (\n    \\begin{bmatrix}\n    \\pmb \\mu_1 \\\\\n    \\pmb \\mu_2\n    \\end{bmatrix}\n    ,\\begin{bmatrix}\n    \\pmb \\Sigma_{11} & \\Sigma_{12} \\\\\n    \\pmb \\Sigma^t_{12} & \\Sigma_{22}\n    \\end{bmatrix}\n    \\right )\n  \\]\n확률벡터 \\(\\pmb X_2 = \\pmb x_2\\)가 주어진 경우 \\(\\pmb X_1\\)의 조건부 분포는 \\(p\\)-차원 다변량 정규분포를 따르고 평균과 공분산은 다음과 같다.\n\\[\n  E(\\pmb X_1 | \\pmb X_2 = \\pmb x_2 ) = \\pmb \\mu_1 + \\pmb \\Sigma_{12} \\pmb \\Sigma^{-1}_{22} (\\pmb \\mu_2 - \\pmb x_2), \\quad\n  V(\\pmb X_1 | \\pmb X_2 = \\pmb x_2 )  = \\pmb \\Sigma_{11} -\\pmb \\Sigma_{12} \\pmb \\Sigma^{-1}_{22} \\pmb \\Sigma^t_{12}\n  \\]\n만약 \\(X_2 = x_2\\)가 주어졌을 때 \\(X_1\\)의 조건부 분포는 정규분포이고 평균과 분산은 다음과 같이 주어진다.\n\\[\n  E( X_1 |  X_2 =  x_2 ) =  \\mu_1 +  \\frac{\\sigma_{12}}{\\sigma_{22}} ( \\mu_2 -  x_2)  = \\mu_1 +  \\rho \\frac{\\sqrt{\\sigma_{11}}}{\\sqrt{\\sigma_{22}}} ( \\mu_2 -  x_2) \\]\n\\[\n  V( X_1 |  X_2 =  x_2 )  =  \\sigma_{11} - \\frac{\\sigma^2_{12}}{\\sigma_{22}}  = \\sigma_{11}(1-\\rho^2)\n\\]",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>확률벡터와 다변량 정규분포</span>"
    ]
  }
]