<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ko" xml:lang="ko"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.34">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>5&nbsp; 판별분석 – 다변량통계학-2025년 2학기</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../qmd/multivar-pca.html" rel="next">
<link href="../qmd/multivar-cov.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-c8ad9e5dbd60b7b70b38521ab19b7da4.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-d3c9390091c69a50683db05bc45f20d8.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "일치 없음",
    "search-matching-documents-text": "일치된 문서",
    "search-copy-link-title": "검색 링크 복사",
    "search-hide-matches-text": "추가 검색 결과 숨기기",
    "search-more-match-text": "추가 검색결과",
    "search-more-matches-text": "추가 검색결과",
    "search-clear-button-title": "제거",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "취소",
    "search-submit-button-title": "검색",
    "search-label": "검색"
  }
}</script>
<script type="text/javascript">
 window.MathJax = {
  tex: {
    macros: {
    RR: '{\\mathbb R}',                    // a simple string replacement
    hatmat:'{\\pmb X ({\\pmb X}^t {\\pmb X} )^{-1} {\\pmb X}^t}',
    bold: ['\\boldsymbol{#1}',1] ,     // this macro has one parameter
    pardiff: ['\\frac{\\partial#2}{\\partial#1}', 2, 'x'], // this macro has an optional parameter that defaults to 'x'
    pardifftwo: ['\\frac{\\partial#1}{\\partial#2}', 2],
    pardiffd: ['\\frac{\\partial#1}{\\partial#2^t \\partial#2}', 2],
    pardiffdd: ['\\frac{\\partial#1}{\\partial#3 \\partial#2}', 3],
    norm: ['\\lVert#1\\rVert',1]
  },
  environments: {
  braced: ["\\left\\{", "\\right\\}"]
  }
 }
};
</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="사이드바 전환" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../qmd/multivar-discrim.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">판별분석</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="사이드바 전환" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="검색" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">다변량통계학-2025년 2학기</a> 
        <div class="sidebar-tools-main">
    <a href="../다변량통계학-2025년-2학기.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="검색"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/multivar-dist.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">확률벡터와 다변량 정규분포</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/multivar-vis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">다변량 자료의 시각화</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/multivar-test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">다변량 가설 검정</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/multivar-cov.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">공분산 행렬의 추정</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/multivar-discrim.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">판별분석</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/multivar-pca.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">주성분 분석</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="토글 섹션">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/math_mat_basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">행렬의 기초</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/app-likelihood-ratio.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">가능도비 검정</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">목차</h2>
   
  <ul>
  <li><a href="#분포와-판별규칙" id="toc-분포와-판별규칙" class="nav-link active" data-scroll-target="#분포와-판별규칙"><span class="header-section-number">5.1</span> 분포와 판별규칙</a>
  <ul class="collapse">
  <li><a href="#판별-오류와-비용" id="toc-판별-오류와-비용" class="nav-link" data-scroll-target="#판별-오류와-비용"><span class="header-section-number">5.1.1</span> 판별 오류와 비용</a></li>
  <li><a href="#최대가능도-규칙" id="toc-최대가능도-규칙" class="nav-link" data-scroll-target="#최대가능도-규칙"><span class="header-section-number">5.1.2</span> 최대가능도 규칙</a></li>
  <li><a href="#베이지안-규칙" id="toc-베이지안-규칙" class="nav-link" data-scroll-target="#베이지안-규칙"><span class="header-section-number">5.1.3</span> 베이지안 규칙</a></li>
  <li><a href="#최적-판별-규칙" id="toc-최적-판별-규칙" class="nav-link" data-scroll-target="#최적-판별-규칙"><span class="header-section-number">5.1.4</span> 최적 판별 규칙</a></li>
  </ul></li>
  <li><a href="#다변량-정규분포와-판별-규칙" id="toc-다변량-정규분포와-판별-규칙" class="nav-link" data-scroll-target="#다변량-정규분포와-판별-규칙"><span class="header-section-number">5.2</span> 다변량 정규분포와 판별 규칙</a></li>
  <li><a href="#fisher의-선형-판별함수" id="toc-fisher의-선형-판별함수" class="nav-link" data-scroll-target="#fisher의-선형-판별함수"><span class="header-section-number">5.3</span> Fisher의 선형 판별함수</a></li>
  <li><a href="#예제-잔디깎는-트렉터" id="toc-예제-잔디깎는-트렉터" class="nav-link" data-scroll-target="#예제-잔디깎는-트렉터"><span class="header-section-number">5.4</span> 예제: 잔디깎는 트렉터</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">판별분석</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mvtnorm)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rmarkdown)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(flextable)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co">#아래 3 문장은 한글을 포함한 ggplot 그림이 포함된 HTML, PDF로 만드는 경우 사용</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(showtext)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co">#font_add_google("Nanum Pen Script", "gl")</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">font_add_google</span>(<span class="at">name =</span> <span class="st">"Noto Sans KR"</span>, <span class="at">family =</span> <span class="st">"noto"</span>)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">showtext_auto</span>()</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>의사결정은 주어진 유한개의 선택들 중에서 하나를 고르는 것이다. 예를 들어 은행에서 대출 신청자에게 돈을 빌려줄지 말지, 이동 시에 택시를 탈지, 버스를 탈지 또는 지하철을 탈지 결정해야 한다. 인간은 의사결정을 할 때 어느 정도의 자신만의 규칙에 따라 움직이며(아닌 경우도 많지만..) 여러 번의 시행 착오 등을 거쳐서 좋은 선택을 위해 규칙을 바꾸기도 한다. 또한 유한개의 선택들은 대체로 두 가지의 선택이 있으며 둘 중 하나를 선택하는 경우가 많다.</p>
<p>예를 들어, 신용평가에서 은행은 과거 경험을 통해 두 부류의 고객이 있음을 알고 있다. 즉, 대출을 아무 문제 없이 상환하는 안전 고객과 상환에 어려움을 겪은 위험 고객이다. 새로운 고객이 대출을 신청할 때, 은행은 대출을 해줄지 말지를 결정해야 한다. 은행의 과거 기록은 두 부류의 고객에 대한 다수의 특성값들를 제공하며, 여기에는 나이, 급여, 혼인 여부, 대출 금액 등과 같은 다양한 정보가 포함된다. 새로운 고객은 새로운 특성값을 가지고 있으며 판별 규칙(Discrimination rule)은 이 새로운 고객을 두 집단 중 하나로 분류해야 하는 규칙을 말하는 것이다.</p>
<p>판별분석(Discriminant analysis)은 이러한 의사결정에서 통계적 분포과 방법을 사용하여 자료에 기반한 규칙을 정하는 방법이다. 기본적으로 전체 집단(모집단)이 두 개 이상의 집단들로 나누어져 있다고 생각하고 그 집단들에 대한 확률적 가정(분포 가정)을 고려한다. 같은 집단에 속하는 개체들은 유사하며 다른 집단에 속한 개체들은 그 특성이 다르다고 가정하고 이러한 집단의 특성을 확률적 분포로 나타낸다.</p>
<p>예를 들어 이동시 자가용을 타는 사람들과 대중교통을 타는 사람들은 소득의 분포가 다르다고 가정할 수 있다. 이러한 가정 아래 새로운 개체를 어느 집단에 배정하는지에 대한 규칙을 자료를 이용하여 정하는 방법이 판별분석이며 다양한 분류방법(classification)의 출발점이다. 유의할 점은 규칙을 정할 때 어떤 규칙이 좋은 것인지에 대한 기준을 생각해야 한다. 동일한 상황에서 두 가지 규칙을 비교할 수 있어야 더 나은 의사결정을 할 수 있다.</p>
<p>판별분석에서는 다음과 같은 개념들을 생각헤야 한다.</p>
<ul>
<li><p>모집단을 구성하는 겹치지 않는 집단들(groups)</p></li>
<li><p>집단을 이루는 개체들의 특성(확률변수)과 그에 대한 분포</p></li>
<li><p>개체의 특성을 알 때 소속 집단을 결정하는 규칙</p></li>
<li><p>잘못된 판단(error)과 그에 상응하는 비용(cost)</p></li>
<li><p>어떤 규칙이 좋은 것인지 판단하는 기준</p></li>
</ul>
<section id="분포와-판별규칙" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="분포와-판별규칙"><span class="header-section-number">5.1</span> 분포와 판별규칙</h2>
<p>이 장에서는 두 개의 집단(population) <span class="math inline">\(P_1\)</span> 과 <span class="math inline">\(P_2\)</span> 을 고려한다. 예를 들어 은행에서는 전체 고객을 안전 고객과 위험 고객, 두 집단으로 나눌 수 있다.</p>
<p>각 집단에 속하는 개체들의 특성(확률벡터) <span class="math inline">\(\pmb X\)</span> 은 속하는 집단에 따라서 각각 분포 <span class="math inline">\(F_i(\pmb x)\)</span>, <span class="math inline">\(i=1,2\)</span> 를 따른다고 가정한다. 또한 <span class="math inline">\(f_i(\pmb x)\)</span>를 분포 <span class="math inline">\(F_i\)</span>의 확률밀도함수라고 하자.</p>
<p>판별 규칙(discrimination rule) 은 새로운 개체의 특성 <span class="math inline">\(\pmb X = \pmb x\)</span> 가 주어졌을 때 이 개체가 어느 집단에 속하는지 결정하는 방법이다. 이러한 규칙은 개체의 특성삾이 가질 수 있는 전체 공간(표본공간)을 겹치지 않는 두 집합 <span class="math inline">\(R_1\)</span> 과 <span class="math inline">\(R_2\)</span> 로 나누고 관측된 값이 <span class="math inline">\(R_1\)</span> 에 속하면 새로운 개체를 <span class="math inline">\(P_1\)</span> 에 베정하고, 반대로 <span class="math inline">\(R_2\)</span> 에 속하면 <span class="math inline">\(P_2\)</span>에 배정하는 것으로 주어진다.</p>
<p><span id="eq-discrim-rule1"><span class="math display">\[
\text { where }  R_1 \cup R_2 = \RR^p, \quad R_1 \cap R_2 = \emptyset
\tag{5.1}\]</span></span></p>
<p>즉, <span class="math inline">\(R_1\)</span> 과 <span class="math inline">\(R_2\)</span> 는 전체 공간을 겹치지 않게 나누는 두 집합이다. 판별 규칙은 다음과 같이 쓸 수 있다. <span id="eq-discrim-rule2"><span class="math display">\[
\pmb x \in R_1 \Rightarrow \text{개체를 } P_1 \text{에 배정} \\
\pmb x \in R_2 \Rightarrow \text{개체를 } P_2 \text{에 배정}
\tag{5.2}\]</span></span></p>
<section id="판별-오류와-비용" class="level3" data-number="5.1.1">
<h3 data-number="5.1.1" class="anchored" data-anchor-id="판별-오류와-비용"><span class="header-section-number">5.1.1</span> 판별 오류와 비용</h3>
<p>이제 <span class="math inline">\(i\)</span> 집단에 속한 개체가 주어진 판별 규칙에 따라서 <span class="math inline">\(j\)</span> 집단에 배정될 사건과 확률을 생각헤 보자. 먼저 <span class="math inline">\(i\)</span> 집단에 속한 개체가 <span class="math inline">\(j\)</span> 집단에 배정될 사건을 <span class="math inline">\(A(j|i) \equiv A_{ji}\)</span> 라고 정의한다. 따라서 각 개체가 자신이 속한 집단에 배정된 사건, <span class="math inline">\(A_{11}\)</span> 과 <span class="math inline">\(A_{22}\)</span> 가 발생하면 판별규칙이 잘 적용된 경우이다. 반대로 개체가 자신이 속하지 않은 다른 집단에 배정된 사건, <span class="math inline">\(A_{12}\)</span> 과 <span class="math inline">\(A_{21}\)</span> 가 발생하면 오류가 발생한 경우이며 이러한 경우 오류에 의한 비용 <span class="math inline">\(c_{12}\)</span>, <span class="math inline">\(c_{21}\)</span> 이 발생한다.</p>
<p>예를 들어 은행에서 대출 신청자가 우량 고객 <span class="math inline">\(P_1\)</span> 에 속하는데 불량 고객 <span class="math inline">\(P_2\)</span> 로 잘못 판별되어 대출을 거절하는 경우, 은행은 대출 이익을 얻지 못하는 손실 <span class="math inline">\(c_{21}\)</span> 이 발생한다. 반대로 불량 고객 <span class="math inline">\(P_2\)</span> 가 우량 고객 <span class="math inline">\(P_1\)</span> 으로 잘못 판별되어 대출을 해주는 경우, 은행은 대출금을 상환받지 못하는 더 큰 손실 <span class="math inline">\(c_{12}\)</span> 이 발생한다. 따라서 두 가지 오류에 대한 비용은 일반적으로 다르며, 이러한 비용을 고려하여 판별 규칙을 정하는 것이 중요하다.</p>
</section>
<section id="최대가능도-규칙" class="level3" data-number="5.1.2">
<h3 data-number="5.1.2" class="anchored" data-anchor-id="최대가능도-규칙"><span class="header-section-number">5.1.2</span> 최대가능도 규칙</h3>
<p>이제 위에서 정의한 사건과 비용을 이용하여 판별 분석에서 다루는 중요한 확률을 생각해보자. 먼저 첫 집단 <span class="math inline">\(P_1\)</span> 에 속한 개체가 주어진 판별 규칙에 따라서 두 번째 집단 <span class="math inline">\(P_2\)</span> 에 배정될 사건확률은 다음과 같다.</p>
<p><span id="eq-discrim-error-prob1"><span class="math display">\[
p_{21} \equiv P(A_{21}) = \int_{R_2} f_1(\pmb x) d\pmb x
\tag{5.3}\]</span></span></p>
<p>마찬가지로 <span class="math inline">\(P_2\)</span> 에 속한 개체가 <span class="math inline">\(P_1\)</span> 에 배정될 확률은 다음과 같다.</p>
<p><span id="eq-discrim-error-prob2"><span class="math display">\[
p_{12} \equiv P(A_{12}) = \int_{R_1} f_2(\pmb x) d\pmb x
\tag{5.4}\]</span></span></p>
<p>위에서 정의한 두 확률 <span class="math inline">\(p_{12}\)</span> 와 <span class="math inline">\(p_{21}\)</span> 은 판별에서 오류가 발생한 확률이다.</p>
<p>판별 규칙을 만드는 것은 <a href="#eq-discrim-rule1" class="quarto-xref">식&nbsp;<span>5.1</span></a> 과 <a href="#eq-discrim-rule2" class="quarto-xref">식&nbsp;<span>5.2</span></a> 에서 정의한 두 집합 <span class="math inline">\(R_1\)</span> 과 <span class="math inline">\(R_2\)</span> 를 정하는 것이다. 따라서 잘못된 분류를 범할 확률 <a href="#eq-discrim-error-prob1" class="quarto-xref">식&nbsp;<span>5.3</span></a> 과 <a href="#eq-discrim-error-prob2" class="quarto-xref">식&nbsp;<span>5.4</span></a> 은 판별 규칙에 따라서 달라진다. 즉, <span class="math inline">\(R_1\)</span> 과 <span class="math inline">\(R_2\)</span> 를 다르게 정하면 오류 확률도 달라진다.</p>
<p>판별 규칙은 당연히 두 오류의 확률을 가장 작게 만드는 방향으로 정해져야 한다. 이제 앞에서 정의한 두 그룹의 분포를 이용하여 오류의 확률을 가장 작게 만드는 판별 규칙을 어떻게 정할 수 있는지 알아보자. 다음과 같이 두 오류를 범할 확률을 최소로 하는 판별 규칙을 찾으려 한다</p>
<p><span id="eq-discrim-error-opt-condition"><span class="math display">\[
\min_{R_1, R_2} \{ p_{12} + p_{21} \} = \min_{R_1, R_2} \left [ \int_{R_1} f_2(\pmb x) d\pmb x + \int_{R_2} f_1(\pmb x) d\pmb x \right ]
\tag{5.5}\]</span></span></p>
<p>위의 식은 두 오류 확률의 합을 최소로 하는 판별 규칙을 찾는 문제이다. 두 종류의 오류를 범할 확률의 합을 다시 살펴보면 다음과 같이 쓸 수 있다.</p>
<p><span id="eq-discrim-error-opt-condition2"><span class="math display">\[
\begin{aligned}
p_{12} + p_{21} &amp; = \int_{R_1} f_2(\pmb x) d\pmb x + \int_{R_2} f_1(\pmb x) d\pmb x \\
&amp; = \int_{R_1} f_2(\pmb x) d\pmb x + 1 - \int_{R_1} f_1(\pmb x) d\pmb x \\
&amp; = 1 + \int_{R_1} \{ f_2(\pmb x) - f_1(\pmb x) \} d\pmb x
\end{aligned}
\tag{5.6}\]</span></span></p>
<p>참고로 위의 식은 전채 공간에서의 확률밀도함수의 적분이 1임을 이용하였다.</p>
<p><span class="math display">\[
\int_{R_1} f_1{\pmb x} d \pmb x + \int_{R_2} f_1(\pmb x) d\pmb x = 1
\]</span></p>
<p>이제 <a href="#eq-discrim-error-opt-condition2" class="quarto-xref">식&nbsp;<span>5.6</span></a> 의 적분값을 최소로 하는 <span class="math inline">\(R_1\)</span> 을 찾으면 된다. 이 적분값을 최소로 하기 위해서는 적분하는 영역 <span class="math inline">\(R_1\)</span> 에서 적분하는 함수 <span class="math inline">\(f_2(\pmb x) - f_1(\pmb x)\)</span> 의 값이 음수인 부분만 포함되도록 하면 된다. 즉, 다음과 같은 조건을 만족하는 <span class="math inline">\(R_1\)</span> 을 찾으면 된다.</p>
<p><span id="eq-discrim-optimal-region1"><span class="math display">\[
R_1 = \{ \pmb x | f_2(\pmb x) - f_1(\pmb x) &lt; 0 \} = \{ \pmb x | f_1(\pmb x) &gt; f_2(\pmb x) \}
\tag{5.7}\]</span></span></p>
<p>만약 <span class="math inline">\(R_1\)</span> 을 <a href="#eq-discrim-optimal-region1" class="quarto-xref">식&nbsp;<span>5.7</span></a> 과 같이 정하면 <span class="math inline">\(R_2\)</span> 는 자동으로 다음과 같이 정해진다.</p>
<p><span id="eq-discrim-optimal-region2"><span class="math display">\[
R_2 = \{ \pmb x | f_2(\pmb x) \ge f_1(\pmb x) \}
\tag{5.8}\]</span></span></p>
<p>위의 유도에서 판별 규칙을 만들 때 중요한 요인은 두 확률밀도함수의 비(ratio)이다. 두 확률밀도함수의 비가 1 보다 큰 값을 가지는 표본 <span class="math inline">\(\pmb x\)</span> 의 영역과 1 보다 작은 값을 가지는 표본 <span class="math inline">\(\pmb x\)</span> 의 영역이 각각 <span class="math inline">\(R_1\)</span> 과 <span class="math inline">\(R_2\)</span>가 되는 것이다.</p>
<p><span class="math display">\[  \frac{f_1(\pmb x)}{f_2(\pmb x)} \]</span></p>
<p>앞에서 살펴보았듯이, 판별 함수를 만드는 가장 기본적인 방법은 최대 가능도 규칙(Maximum Likelihood Rule)이다. 이 방법은 새로운 개체의 특성 <span class="math inline">\(\pmb X = \pmb x\)</span> 가 주어졌을 때, 각 집단에서 이 특성이 관측될 가능도(likelihood function)를 계산하여 더 큰 집단에 개체를 배정하는 방법이다. 즉, 다음과 같이 판별 규칙을 정의한다.</p>
<p><span class="math display">\[
\pmb x \in R_1 \text{ if } f_1(\pmb x) &gt; f_2(\pmb x), \quad \text{ and } \quad \pmb x \in R_2 \text{ if } f_1(\pmb x) \le f_2(\pmb x)
\]</span></p>
</section>
<section id="베이지안-규칙" class="level3" data-number="5.1.3">
<h3 data-number="5.1.3" class="anchored" data-anchor-id="베이지안-규칙"><span class="header-section-number">5.1.3</span> 베이지안 규칙</h3>
<p>만약 각 집단에 속할 사전 확률(prior probability)이 각각 <span class="math inline">\(\pi_1\)</span> , <span class="math inline">\(\pi_2\)</span> 로 주어졌다고 하자. 사전확률은 관측하는 확률벡터의 분포를 고려하기 전에, 어떤 개체가 각 집단에 속할 가능성을 확률을 나타낸 것이다.</p>
<p>예를 들어 앞에서 생각한 예제에서 은행의 대출 신청자가 우량 고객 집단에 속할 가능성과 물량 고객 집단에 속할 가능성이 다를 수 있다. 대부분의 사람들이 대출을 계획대로 상환하였다면 임의의 고객이 우량 고객일 가능성이 불량 고객일 가능성보다 매우 크다고 할 수 있다. 이러한 사전 정보를 고려하여 판별 규칙을 정하는 임의의 고객이 우량 고객 집단 <span class="math inline">\(P_1\)</span> 에 속할 사전 확률을 <span class="math inline">\(\pi_1\)</span> 이라고 하고 불량 고객 <span class="math inline">\(P_2\)</span> 에 속할 사전 확률이 <span class="math inline">\(\pi_2\)</span> 라고 할 수 있는 것이다.</p>
<p><span class="math display">\[ \pi_1  = P(\text{고객} \in  P_1), \quad \pi_2 = P(\text{고객} \in P_2), \quad \pi_1 + \pi_2 =1 \]</span></p>
<p>사전확률을 고려하는 경우, 베이즈 판별 규칙은 다음과 같이 정의된다. 즉, 새로운 개체의 특성 <span class="math inline">\(\pmb X = \pmb x\)</span> 가 주어졌을 때, 각 집단에서 이 특성이 관측될 가능도(likelihood function)에 사전 확률을 곱한 값을 계산하여 더 큰 집단에 개체를 배정하는 방법이다. 이 경우 베이즈 판별 규칙(Bayes Discrimination Rule)은 다음과 같이 정의된다.</p>
<p><span class="math display">\[
\pmb x \in R_1 \text{ if } \pi_1 f_1(\pmb x) &gt; \pi_2 f_2(\pmb x), \quad \text{ and } \quad \pmb x \in R_2 \text{ if } \pi_1 f_1(\pmb x) \le \pi_2 f_2(\pmb x)
\]</span><br>
위의 규칙에서 가능도 함수와 사전 확률의 곱을 사후 확률(posterior probability)이라고 한다. 사후 확률은 관측된 표본의 값이 주어진 경우 개체가 집단에 속할 확률을 의미한다.</p>
<p><span class="math display">\[
P (P_i | \pmb X = \pmb x) \propto \pi_i f_i(\pmb x), \quad i=1,2
\]</span></p>
</section>
<section id="최적-판별-규칙" class="level3" data-number="5.1.4">
<h3 data-number="5.1.4" class="anchored" data-anchor-id="최적-판별-규칙"><span class="header-section-number">5.1.4</span> 최적 판별 규칙</h3>
<p>이제 판별에서 발생하는 오류에 대한 비용도 함께 고려할 수 있는 최적의 규칙을 고려해 보자. 앞 절에서 정의한 오류에 대한 비용 <span class="math inline">\(c_{12}\)</span> 와 <span class="math inline">\(c_{21}\)</span> 을 고려할 때 최적 판별 규칙은 다음에서 정의한 기대 오류비용 (Expected cost of misclassification; ECM) 을 최소로 하는 규칙이다.</p>
<p><span id="eq-discrim-ecm"><span class="math display">\[
\text{ECM} = c_{12} p_{12} \pi_2 + c_{21} p_{21} \pi_1
\tag{5.9}\]</span></span></p>
<p>기대 오류비용(ECM)을 최소로 하는 판별 규칙을 유도하면 다음과 같은 최적 판별 규칙을 얻을 수 있다.</p>
<p><span id="eq-discrim-optimal-rule"><span class="math display">\[
R_1 = \left \{ \pmb x | \frac{f_1(\pmb x)}{f_2(\pmb x)} &gt; \left [ \frac{c_{12}}{c_{21}} \right ] \left [ \frac{\pi_2}{\pi_1} \right ] \right \}, \quad R_2 = \left \{ \pmb x | \frac{f_1(\pmb x)}{f_2(\pmb x)} \le \left [ \frac{c_{12}}{c_{21}} \right ] \left [ \frac{\pi_2}{\pi_1} \right ] \right \}
\tag{5.10}\]</span></span></p>
<p><a href="#eq-discrim-optimal-rule" class="quarto-xref">식&nbsp;<span>5.10</span></a> 에서 알 수 있듯이, 최대가능도 규칙과 베이즈 판별 규칙은 기대 오류비용을 최소화하는 최적 규칙의 특별한 경우이다. 즉, 비용이 동일한 경우 <span class="math inline">\(c_{12} = c_{21}\)</span> 에는 베이즈 판별 규칙과 동일하다. 또한 사전 확률도 동일한 경우 <span class="math inline">\(\pi_1 = \pi_2\)</span> 에는 최대 가능도 판별 규칙과 동일하다.</p>
<div id="exr-twonormal" class="theorem exercise">
<p><span class="theorem-title"><strong>예제 5.1 (두 정규 분포의 판별 규칙)</strong></span> 두 집단 <span class="math inline">\(P_1\)</span> 과 <span class="math inline">\(P_2\)</span> 에 속한 개체들의 특성 <span class="math inline">\(\pmb X\)</span> 가 각각 다음과 같은 분산이 동일한 일변량 정규 분포를 따른다고 하자.</p>
<p><span class="math display">\[
X | P_1 \sim N( \mu_1,  \sigma^2), \quad  X | P_2 \sim N(\mu_2, \sigma^2), \quad \mu_1 &lt; \mu_2
\]</span> 이제 두 정규분포 확률밀도함수의 비, 최대가능도 함수의 비율을 고려해 보자.</p>
<p><span class="math display">\[
\frac{f_1(x)}{f_2(x)} =  \exp \left \{ - \left ( \frac{(x - \mu_1)^2}{2\sigma^2} \right ) - \left ( - \frac{(x - \mu_2)^2}{2\sigma^2} \right ) \right \}
\]</span><br>
위의 식에서 두 정규분포의 비가 1 보다 큰 표본의 영역 <span class="math inline">\(R_1\)</span> 을 구하면 다음과 같다.</p>
<p><span class="math display">\[
\begin{aligned}
&amp;   \frac{f_1(x)}{ f_2(x)} &gt; 1 \\
&amp; \Longleftrightarrow   -\frac{1}{2\sigma^2}(x-\mu_1)^2  + \frac{1}{2\sigma^2}(x-\mu_2)^2 &gt; \log(1) \\
&amp; \Longleftrightarrow   2x\mu_1 -\mu_1^2 -2x \mu_2 + \mu_2^2 &gt; 0 \\
&amp; \Longleftrightarrow   2x(\mu_1 - \mu_2)   &gt; \mu_1^2 - \mu_2^2  \\
&amp; \Longleftrightarrow   x &lt; \frac{\mu_1+\mu_2}{2}
\end{aligned}
\]</span></p>
<p>따라서 두 집단의 평균의 중간에 있는 값 <span class="math inline">\((\mu_1 + \mu_2)/2\)</span> 보다 관측한 값 <span class="math inline">\(x\)</span> 가 작으면 그룹 <span class="math inline">\(P_1\)</span> 에 속한다고 결정한다.</p>
<p><span class="math display">\[
R_1 = \left \{ x | x &lt; \frac{\mu_1 + \mu_2}{2} \right \}, \quad R_2 = \left \{ x | x \ge \frac{\mu_1 + \mu_2}{2} \right \}
\]</span></p>
<p><span class="math inline">\(\square\)</span></p>
</div>
</section>
</section>
<section id="다변량-정규분포와-판별-규칙" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="다변량-정규분포와-판별-규칙"><span class="header-section-number">5.2</span> 다변량 정규분포와 판별 규칙</h2>
<p>앞 절에서는 개체의 특성을 나타내는 확률변수가 일변량 정규분포인 경우의 예제를 보았다. 일반적인 경우 개체의 특성을 나타내는 특성값은 두 개 이상인 경우가 흔하다. 따라서 이제는 개체의 특성이 여러 개의 확률변수, 즉 확률벡터로 구성되어 있다고 가정하자.</p>
<p><span class="math inline">\(p\)</span>차원 확률벡터 <span class="math inline">\(\pmb X\)</span> 를 고려하며 분포는 다변량 정규분포를 가정한다. 정규분포의 가정은 강한 가정이지만 단순하고 다루기 쉬운 분포이며 실제로 사용하기 용이하다. (하지만 조심해서 가정을 검토해야함)</p>
<p>두 개의 다변량정규분포를 따르는 두 집단 <span class="math inline">\(P_1, P_2\)</span>으로 나누어져 있다고 가정하고 두 분포를 고려하자. 처음에는 문제를 쉽게 하기 위하여 평균은 다르고 공분산은 같다고 가정하자</p>
<p><span class="math display">\[
P_1 : ~N_p (\pmb \mu_1, \pmb \Sigma) , \quad  P_2 :~ N(\pmb \mu_2, \pmb \Sigma)   \quad \text{ where } \pmb \mu_1 \ne \pmb \mu_2
\]</span></p>
<p>참고로 다변량 정규 분포의 확률 밀도 함수는 다음과 같다.</p>
<p><span class="math display">\[
f(\pmb x) = (2 \pi)^{-p/2} |\pmb \Sigma |^{-1/2} \exp \left [
-\frac{1}{2} (\pmb x -\pmb \mu)^t \pmb \Sigma^{-1} (\pmb x -\pmb \mu) \right ]
\]</span></p>
<p><a href="#eq-discrim-ecm" class="quarto-xref">식&nbsp;<span>5.9</span></a> 에서 기대 오류비용 ECM 을 최소하는 판별규칙 <a href="#eq-discrim-optimal-rule" class="quarto-xref">식&nbsp;<span>5.10</span></a> 과 같이 구할 수 있으며 이제 다변량 정규분포의 확률밀도함수를 <a href="#eq-discrim-optimal-rule" class="quarto-xref">식&nbsp;<span>5.10</span></a> 에 넣고 판별함수를 유도해 보자.</p>
<p><span class="math display">\[
\begin{aligned}
\frac{f_1(\pmb x)}{f_2(\pmb x)} &amp; =
\exp \left [ -\frac{1}{2} (\pmb x -\pmb \mu_1)^t \pmb \Sigma^{-1} (\pmb x -\pmb \mu_1) +
\frac{1}{2} (\pmb x -\pmb \mu_2)^t \pmb \Sigma^{-1} (\pmb x
-\pmb \mu_2)\right ] \\
&amp; = \exp \left [ (\pmb \mu_1-\pmb \mu_2)^t \pmb \Sigma^{-1} \pmb x -
\frac{1}{2} \pmb \mu_1^t \pmb \Sigma^{-1} \pmb \mu_1
+\frac{1}{2} \pmb \mu_2^t \pmb \Sigma^{-1} \pmb \mu_2) \right ]  \\
&amp;= \exp \left [ (\pmb \mu_1-\pmb \mu_2)^t \pmb \Sigma^{-1} \pmb x -
\frac{1}{2} (\pmb \mu_1-\pmb \mu_2)^t \pmb \Sigma^{-1} (\pmb \mu_1+\pmb \mu_2) \right ]
\end{aligned}
\]</span></p>
<p>이제 ECM을 최소화하는 규칙은 개체의 특성이 <span class="math inline">\(\pmb x =\pmb x_0\)</span> 로 주어진 경우 다음을 만족하면 <span class="math inline">\(P_1\)</span>으로 분류한다.</p>
<p><span class="math display">\[
(\pmb \mu_1-\pmb \mu_2)^t \pmb \Sigma^{-1} \pmb x_0 -
\frac{1}{2} (\pmb \mu_1-\pmb \mu_2)^t \pmb \Sigma^{-1} (\pmb \mu_1+\pmb \mu_2)
&gt; \log \left ( \frac{c_{12}}{c_{21}} \frac{\pi_2}{\pi_1} \right )
\]</span></p>
<p>실제로 <span class="math inline">\(\pmb \mu_1\)</span>, <span class="math inline">\(\pmb \mu_2\)</span>, <span class="math inline">\(\pmb \Sigma\)</span>은 알 수 없기 때문에 표본 자료를 이용하여 추정을 한다.</p>
<p><span class="math display">\[ \hat {\pmb \mu}_1 = \bar {\pmb x}_1 \quad \text{and} \quad \hat {\pmb \mu}_2 = \bar {\pmb x}_2  \]</span></p>
<p><span class="math display">\[ \hat {\pmb \Sigma} = \pmb S_{p} = \frac{(n_1-1) \pmb S_1+(n_2-1)
\pmb S_2}{ n_1+n_2-2 } \]</span></p>
<p>여기서 <span class="math inline">\(n_1\)</span>, <span class="math inline">\(n_2\)</span>는 표본에서 두 그룹에 대한 표본의 크기이며 <span class="math inline">\(\bar {\pmb x}_1\)</span>, <span class="math inline">\(\bar {\pmb x}_2\)</span>는 각각의 표본평균 벡터이다. <span class="math inline">\(\pmb S_{p}\)</span>는 두 개의 그룹에서 구한 공분산 행렬의 추정치를 결합한 합동 공분산 추정량이다.</p>
<p>위에서 구한 모수들의 추정치를 모집단으로 부터 구한 판별함수에 넣으면 다음과 같은 표본을 이용한 판별함수가 얻어진다.</p>
<p><span id="eq-discrim-sample-rule"><span class="math display">\[
(\bar {\pmb x}_1-\bar {\pmb x}_2)^t \pmb S_{p}^{-1} \pmb x_0 -
\frac{1}{2} (\bar {\pmb x}_1-\bar {\pmb x}_2)^t \pmb S_{p}^{-1} (\bar
{\pmb x}_1+\bar {\pmb x}_2) &gt;  \log \left ( \frac{c(1|2)}{c(2|1)}
\frac{\pi_2}{\pi_1} \right )
\tag{5.11}\]</span></span></p>
<p>위 <a href="#eq-discrim-sample-rule" class="quarto-xref">식&nbsp;<span>5.11</span></a> 의 표본 판별함수에서 아래와 같이 벡터 <span class="math inline">\(\pmb a\)</span>와 상수 <span class="math inline">\(m\)</span>을 정의하면</p>
<p><span id="eq-discrim-sample-rule-const"><span class="math display">\[
\begin{aligned}
\pmb a &amp; =  \pmb S_{p}^{-1} (\bar {\pmb x}_1-\bar {\pmb x}_2)   \\
m &amp;  = \frac{1}{2} (\bar {\pmb x}_1-\bar {\pmb x}_2)^t
\pmb S_{p}^{-1} (\bar {\pmb x}_1+\bar {\pmb x}_2) = \frac{1}{2}(\pmb a^t
\bar {\pmb x}_1 + \pmb a^t \bar {\pmb x}_2)
\end{aligned}
\tag{5.12}\]</span></span></p>
<p>ECM을 최소화하는 판별 규칙은 다음과 같이 특성값 <span class="math inline">\(\pmb x_0\)</span>의 <strong>선형함수</strong>로 나타낼 수 있다.</p>
<p><span id="eq-discrim-linear-rule"><span class="math display">\[
\pmb a^t \pmb x_0 &gt;  m + \log \left ( \frac{c(1|2)}{c(2|1)} \frac{\pi_2}{\pi_1} \right )
\tag{5.13}\]</span></span></p>
<p>만약 비용이 같고 (<span class="math inline">\(c_{12}=c_{21}\)</span>) 두 집단에 대한 사전확률이 같다면 (<span class="math inline">\(\pi_1=\pi_2\)</span>) 판별함수는 다음과 같이 간단하게 나타낼 수 있다.</p>
<p><span id="eq-discrim-linear-rule2"><span class="math display">\[  
\pmb a^t \pmb x_0     &gt; m
\tag{5.14}\]</span></span></p>
<p>마지막으로 두 모집단의 공분산이 다를 경우는 판별함수가 확률벡터 <span class="math inline">\(\pmb x\)</span>의 선형함수로 나타나지 않는다.</p>
<!--- 
두 개의 다변량 정규분포에서 공분산이 다를 때 $\pmb \Sigma_1 \ne \pmb \Sigma_2$ 각 집단에 대하여 
공분산 행렬을 따로 추정한다.
\[ \hat {\pmb \Sigma}_1 = \pmb S_1 \quad \text{and} \quad \hat {\pmb \Sigma}_2 = \pmb S_2 \]
또한 ECM을 최소화하는 판별규칙을 유도해보면  $\pmb x$의 선형함수로 나타나지 않는다.
개체의 특성이 $\pmb x_0$일 때 다음을 만족하면 $P_1$ 집단으로 분류한다.
\[ -\frac{1}{2} \pmb x^t_0 (\pmb S_{1}^{-1} -\pmb S_{2}^{-1})\pmb x_0 +
(\bar {\pmb x}_1 \pmb S_{1}^{-1} - \bar {\pmb x}_2 \pmb S_{2}^{-1} )\pmb x^t_0
-k >  \log \left ( \frac{c(1|2)}{c(2|1)} \frac{p_2}{p_1} \right )
\]
여기서 
\[
k= \frac{1}{2} \log \left ( \frac{| \pmb \Sigma_1 |}{| \pmb \Sigma_2 |}
\right ) + \frac{1}{2} (\pmb \mu_1^t \pmb \Sigma_1^{-1} \pmb \mu_1 -
\pmb \mu_2^t \pmb \Sigma_2^{-1} \pmb \mu_2) \]
--->
</section>
<section id="fisher의-선형-판별함수" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="fisher의-선형-판별함수"><span class="header-section-number">5.3</span> Fisher의 선형 판별함수</h2>
<p>Fisher(1938)는 위에서 다룬 ECM을 최소화하는 판별함수를 유도하는 방법과 완전히 다른 규칙을 사용하여 ECM을 최소화하는 방법과 동일한 결과를 유도하였다.</p>
<p>Fisher는 다변량 확률벡터 <span class="math inline">\(\pmb x\)</span>를 일변량 변수 <span class="math inline">\(y\)</span> 로 선형변환하여 차원을 축소하는 방법을 고려하였다. 차원을 축소할 때 축소된 차원의 특성값 <span class="math inline">\(y\)</span>가 두 집단을 최대로 구별되게 하는 선형변환을 구하는 문제를 생각하였다. Fisher의 방법은 특성값 벡터 <span class="math inline">\(\pmb x\)</span>에 확률적 분포가정을 고려하지 않는다.</p>
<p>특성값 벡터 <span class="math inline">\(\pmb x_1\)</span>을 집단 <span class="math inline">\(P_1\)</span>의 특성값이라고 하고 <span class="math inline">\(\pmb x_2\)</span>을 집단 <span class="math inline">\(P_2\)</span>의 특성벡터라고 하자. 이제 특성값 벡터 <span class="math inline">\(\pmb x_1\)</span>과 <span class="math inline">\(\pmb x_2\)</span>에 동시에 적용하는 선형변환 벡터를 <span class="math inline">\(\pmb a\)</span>라고 하고 각 집단의 일변량 특성값 <span class="math inline">\(y_1\)</span>과 $ y_2$를 다음과 같이 정의하자.</p>
<p><span class="math display">\[
y_1 = \pmb a^t \pmb x_1 \quad \text{and} \quad y_2 = \pmb a^t \pmb x_2
\]</span> 이제 두 집단에서 각각 <span class="math inline">\(n_1\)</span>, <span class="math inline">\(n_2\)</span> 개의 표본을 독립적으로 추출하였다거 가정하자.</p>
<p><span class="math display">\[
y_{11}, y_{12}, \dots, y_{1 n_1} \sim_{ind} P_1 \quad \text{and} \quad y_{21}, y_{22}, \dots, y_{2 n_2} \sim_{ind} P_2
\]</span> 각 집단의 평균벡터는 다음과 같이 일변량 평균으로 변환된다. <span class="math display">\[
\bar y_1 = \pmb a^t \bar {\pmb x}_1 \quad \text{and} \quad \bar y_2 = \pmb a^t \bar {\pmb x}_2
\]</span></p>
<p>Fisher의 방법은 변환된 일변량 변수 <span class="math inline">\(y\)</span>가 두 집단 간의 차이를 최대로, 집단 내의 차이를 최소로 하도록 하는 선형변환 <span class="math inline">\(\pmb a\)</span>를 유도하는 것이다.</p>
<p>두 집단 간의 차이를 최대로 하는 것은 두 평균의 차이 <span class="math inline">\(|\bar y_1 -\bar y_2|\)</span>가 커지게 하는 것이고 집단 내의 차이를 최소로 하도록 하는 것은 집단내의 변동, 즉 집단내의 분산을 작게하는 것이다. 이러한 두 집단 간의 차이와 집단 내의 변동을 같이 반영할 수 있는 측도를 다음과 같이 생각하였다.</p>
<p><span id="eq-discrim-target"><span class="math display">\[
\max_{\pmb a} \frac {| \bar y_1 - \bar y_2|} {s_y} =  \max \frac{ \text{variation between groups}}{\text{variation within group}}
\tag{5.15}\]</span></span></p>
<p>여기서 $s^2_y $는 두 집단의 특성값 <span class="math inline">\(y\)</span>의 합동분산 추정량이다.</p>
<p><span class="math display">\[
s^2_y =\frac {\sum_{j=1}^{ n_1}(y_{1j} -\bar y_1)^2 + \sum_{j=1}^{ n_2}(y_{2j} -\bar y_2)^2 }{n_1+n_2-2}
\]</span></p>
<p>이제 두 집단 간의 차이를 최대로, 집단 내의 변동를 최소로 하는 변환을 유도해보자. <a href="#eq-discrim-target" class="quarto-xref">식&nbsp;<span>5.15</span></a> 에 제시된 값의 제곱이 가질 수 있는 상한(upper bound)을 유도하고 그 상한값을 취하는 선형변환 벡터 <span class="math inline">\(\pmb a\)</span>를 찾아보자.</p>
<p>여기서 두 집단의 평균벡터의 차이 <span class="math inline">\(\pmb d\)</span>를 다음과 같이 정의한다.</p>
<p><span class="math display">\[
\pmb d =(\bar {\pmb x}_1 - \bar {\pmb x}_2)
\]</span></p>
<p>이제 <a href="#eq-discrim-target" class="quarto-xref">식&nbsp;<span>5.15</span></a> 에 주어진 값의 제곱에 대한 상한을 유도해보자.</p>
<p><span id="eq-discrim-fisher-bound"><span class="math display">\[
\begin{aligned}
\frac {( \bar y_1 - \bar y_2)^2} {s^2_y}
&amp;=  \frac{ ( \pmb a^t \bar {\pmb x}_1 -  \pmb a^t \bar {\pmb x}_2)^2}
{ \pmb a^t \pmb S_{p}  \pmb a } \\
&amp; =   \frac{ [ \pmb a^t (\bar {\pmb x}_1 - \bar {\pmb x}_2)]^2}
{ \pmb a^t \pmb S_{p}  \pmb a } \\
&amp; =   \frac{ ( \pmb a^t \pmb d)^2}
{ \pmb a^t \pmb S_{p}  \pmb a } \\
&amp;=   \frac{ ( \pmb a^t  \pmb S_{p}^{1/2} \pmb S_{p}^{-1/2} \pmb d)^2}
{ \pmb a^t \pmb S_{p}  \pmb a } \\
&amp; \le   \frac{ ( \pmb a^t  \pmb S_{p} \pmb a) ( \pmb d^t \pmb S_{p}^{-1} \pmb d)}
{ \pmb a^t \pmb S_{p}  \pmb a } \\
&amp;= \pmb d^t \pmb S^{-1}_{p} \pmb d
\end{aligned}
\tag{5.16}\]</span></span></p>
<p>위에서 부등식은 코쉬-쉬바르쯔 부등식(Cauchy–Schwarz Inequality) 을 적용한 결과이며 부등식의 등호는 다음과 같은 경우에 성립한다.</p>
<p><span id="eq-discrim-fisher-optimal"><span class="math display">\[
\pmb a = \pmb S^{-1}_{p} \pmb d = \pmb S^{-1}_{p} (\bar {\pmb x}_1 - \bar {\pmb x}_2)
\tag{5.17}\]</span></span></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
코쉬-쉬바르쯔 부등식
</div>
</div>
<div class="callout-body-container callout-body">
<p>두 벡터 <span class="math inline">\(\pmb u\)</span>와 <span class="math inline">\(\pmb v\)</span>에 대하여 다음 부등식(Cauchy–Schwarz Inequality)이 성립한다.</p>
<p><span class="math display">\[
|\pmb u^t \pmb v|^2 \le (\pmb u^t \pmb u)(\pmb v^t \pmb v)
\]</span> 부등식의 등호는 <span class="math inline">\(\pmb u\)</span>와 <span class="math inline">\(\pmb v\)</span>가 선형종속일 때, 즉 <span class="math inline">\(\pmb u = c \pmb v\)</span> 인 경우 성립한다.</p>
<p><a href="#eq-discrim-fisher-bound" class="quarto-xref">식&nbsp;<span>5.16</span></a> 에서 다음과 같이 벡터 <span class="math inline">\(\pmb u\)</span> 와 <span class="math inline">\(\pmb v\)</span> 를 적용하면 원하는 결과를 얻는다.</p>
<p><span class="math display">\[
\pmb u = \pmb S_{p}^{1/2} \pmb a \quad \text{and} \quad \pmb v = \pmb S_{p}^{-1/2} \pmb d
\]</span></p>
</div>
</div>
<p><a href="#eq-discrim-fisher-optimal" class="quarto-xref">식&nbsp;<span>5.17</span></a> 에서 유도한 선형변환 벡터 <span class="math inline">\(\pmb a\)</span>는 다변량 정규분포 가정하에서 ECM을 최소화하는 판별함수의 선형벡터 <a href="#eq-discrim-sample-rule-const" class="quarto-xref">식&nbsp;<span>5.12</span></a> 와 동일하다.</p>
<p>더 나아가 <a href="#exr-twonormal" class="quarto-xref">예제&nbsp;<span>5.1</span></a> 의 결과를 이용하면, 두 집단의 평균이 각각 <span class="math inline">\(\bar y_1\)</span> 과 <span class="math inline">\(\bar y_2\)</span> 이므로 새로운 관측값 <span class="math inline">\(y_0 = \pmb a^t \pmb x_0\)</span> 의 값을 두 평균의 가운데 값, 즉 <span class="math inline">\(m=(\bar y_1 + \bar y_2)/2\)</span>와 비교하여 판별할 수 있다. 즉, 개체의 특성값 <span class="math inline">\(y_0 = \pmb a^t \pmb x_0\)</span>일 때 다음을 만족하면 집단 <span class="math inline">\(P_1\)</span>으로 분류한다.</p>
<p><span class="math display">\[  
y_0  &gt;  m
\]</span></p>
<p>여기서</p>
<p><span class="math display">\[
y_0= \pmb a^t\pmb x_0=  (\bar {\pmb x}_1-\bar {\pmb x}_2)^t \pmb S_{p}^{-1} \pmb x_0
\]</span></p>
<p><span class="math display">\[
m=\frac{1}{2} (\bar {\pmb x}_1-\bar {\pmb x}_2)^t \pmb S_{p}^{-1} (\bar
{\pmb x}_1+\bar {\pmb x}_2)= \frac{1}{2} \pmb a^t (\bar
{\pmb x}_1+\bar {\pmb x}_2)  = \frac{1}{2} {(\bar y_1 +\bar y_2} )
\]</span></p>
<p>따라서 Fisher의 판별함수에 의한 분류 규칙은 다변량 정규분포 가정하에 ECM을 최소로 하는 규칙 <a href="#eq-discrim-linear-rule2" class="quarto-xref">식&nbsp;<span>5.14</span></a> 과 동일하다.</p>
</section>
<section id="예제-잔디깎는-트렉터" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="예제-잔디깎는-트렉터"><span class="header-section-number">5.4</span> 예제: 잔디깎는 트렉터</h2>
<p>다음은 미국에서 한 소비용품 판매점이 잔디깍는 트랙터(lawn mower)의 소유 여부에 대한 가구의 소득과 집 크기의 관계를 알아보기 위하여 고객의 정보를 수집한 자료이다. 총 24개의 자료가 있고 트랙터를 소유하지 않는 집과 소유한 집이 각각 12개이다.</p>
<p>변수 <code>income</code> 과 <code>lotsize</code> 는 각각 가구 소득과 집의 크기에 대한 변수이다. 트랙터를 소유한 상태를 나타내는 변수는 <code>class</code> 이며 값이 2 이면 소유하지 않는 상태(<code>NO</code>,<strong>그룹 1</strong>), 1 이면 소유한 상태(<code>YES</code>, <strong>그룹 2</strong>) 를 나타낸다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># read data</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">here</span>(<span class="st">"data"</span>,<span class="st">"lawn.csv"</span>) , <span class="at">header=</span>T, <span class="at">sep=</span><span class="st">""</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>class <span class="ot">&lt;-</span> <span class="fu">factor</span>(df<span class="sc">$</span>class, <span class="at">levels=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>), <span class="at">labels=</span><span class="fu">c</span>( <span class="st">"NO"</span>,<span class="st">"YES"</span>))</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df)</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  income lotsize class
1   60.0    18.4   YES
2   85.5    16.8   YES
3   64.8    21.6   YES
4   61.5    20.8   YES
5   87.0    23.6   YES
6  110.1    19.2   YES</code></pre>
</div>
</div>
<p>이제 트렉터 소유의 여부와 소득/집크기의 관계를 알아보기 위하여 이차원에 자료를 그림으로 나타내보자.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot data wiyth different symbol by uisng ggplot2</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>income,<span class="at">y=</span>lotsize, <span class="at">shape=</span>class, <span class="at">color=</span>class)) <span class="sc">+</span> </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">4</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"가구 소득"</span>,<span class="at">y=</span><span class="st">"집 면적 "</span>,<span class="at">shape=</span><span class="st">"소유 여부"</span>, <span class="at">color =</span> <span class="st">"소유 여부"</span>)</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="multivar-discrim_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>이제 앞절에서 유도한 선형판별함수를 트렉터 자료에 적용하여 판별함수를 구해보자. 일단 표본 평균벡터와 합동 공분산 행렬을 계산한다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 각 그룹의 표본 크기</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="fu">sum</span>(df<span class="sc">$</span>class <span class="sc">==</span> <span class="st">"NO"</span> )</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(df<span class="sc">$</span>class <span class="sc">==</span> <span class="st">"YES"</span> )</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>n1</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 12</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>n2</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 12</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 각 그룹의 평균벡터</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>mean_vec <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>   <span class="fu">group_by</span>(class) <span class="sc">%&gt;%</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">c</span>(income, lotsize), mean))</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>mean_vec</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  class income lotsize
  &lt;fct&gt;  &lt;dbl&gt;   &lt;dbl&gt;
1 NO      57.4    17.6
2 YES     79.5    20.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>mean_x1 <span class="ot">&lt;-</span> mean_vec <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(class <span class="sc">==</span> <span class="st">"NO"</span> ) <span class="sc">%&gt;%</span> </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(income, lotsize) <span class="sc">%&gt;%</span> </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>() <span class="sc">%&gt;%</span> <span class="fu">t</span>()</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>mean_x2 <span class="ot">&lt;-</span> mean_vec <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(class <span class="sc">==</span> <span class="st">"YES"</span> ) <span class="sc">%&gt;%</span> </span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(income, lotsize) <span class="sc">%&gt;%</span> </span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>() <span class="sc">%&gt;%</span> <span class="fu">t</span>()</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>mean_x1</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            [,1]
income  57.40000
lotsize 17.63333</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>mean_x2</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            [,1]
income  79.47500
lotsize 20.26667</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 각 그룹의 공분산 행렬</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>cov_tbl <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(class) <span class="sc">%&gt;%</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">cov =</span> <span class="fu">list</span>(<span class="fu">cov</span>(<span class="fu">across</span>(<span class="fu">c</span>(income, lotsize)))), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>cov_x1 <span class="ot">&lt;-</span> cov_tbl <span class="sc">%&gt;%</span> <span class="fu">filter</span>(class <span class="sc">==</span> <span class="st">"NO"</span> ) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(cov) <span class="sc">%&gt;%</span> .[[<span class="dv">1</span>]]</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>cov_x1</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            income   lotsize
income  200.705455 -2.589091
lotsize  -2.589091  4.464242</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>cov_x2 <span class="ot">&lt;-</span> cov_tbl <span class="sc">%&gt;%</span> <span class="fu">filter</span>(class <span class="sc">==</span> <span class="st">"YES"</span> ) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(cov) <span class="sc">%&gt;%</span> .[[<span class="dv">1</span>]]</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>cov_x2</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           income    lotsize
income  352.64386 -11.818182
lotsize -11.81818   4.082424</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 합동 공분산 행렬</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co">#cov_p &lt;- ((n1-1)*cov_x1 + (n2-1)*cov_x2)/(n1+n2-2)</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>cov_p <span class="ot">&lt;-</span> (n1<span class="sc">*</span>cov_x1 <span class="sc">+</span> n2<span class="sc">*</span>cov_x2)<span class="sc">/</span>(n1<span class="sc">+</span>n2)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>cov_p</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            income   lotsize
income  276.674659 -7.203636
lotsize  -7.203636  4.273333</code></pre>
</div>
</div>
<p>이제 트렉터 자료에 적용하여 앞장에서 구한 최적의 판별 규칙을 유도해보자. 먼저 <a href="#eq-discrim-sample-rule-const" class="quarto-xref">식&nbsp;<span>5.12</span></a> 와 <a href="#eq-discrim-fisher-optimal" class="quarto-xref">식&nbsp;<span>5.17</span></a> 에 나타난 최적 변환 벡터 <span class="math inline">\(\pmb a\)</span> 와 상수 <span class="math inline">\(m\)</span> 는 다음과 같이 구할 수 있다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># find discriminant function </span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">solve</span>(cov_p) <span class="sc">%*%</span>  (mean_x1 <span class="sc">-</span> mean_x2) </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>a</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              [,1]
income  -0.1002303
lotsize -0.7851847</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">t</span>(mean_x1 <span class="sc">-</span> mean_x2) <span class="sc">%*%</span> <span class="fu">solve</span>(cov_p) <span class="sc">%*%</span> (mean_x1 <span class="sc">+</span> mean_x2)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>m</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          [,1]
[1,] -21.73876</code></pre>
</div>
</div>
<p>따라서 새로운 특성값 벡터를 <span class="math inline">\(\pmb x_0= (x_{10},~x_{20})^t\)</span> 이라고 하면 ECM을 최소화하는 판별함수는 다음과 같이 주어진다. 즉, 다음 조건이 만족하면 그룹 1, 즉 트랙터를 사지 않는 그룹에 속한다.</p>
<p><span class="math display">\[
(-0.1002303) \times  (x_{10})  + (-0.7851847) \times  (x_{20})  &gt; -21.7387617
\]</span></p>
<p>만약 <code>income</code> 과 <code>lotsize</code>가 각각 70, 16 이라면 다음과 같이 <span class="math inline">\(\pmb a^t \pmb x_0\)</span> 를 구할 수 있다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>x_0 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">70</span>, <span class="dv">16</span>),<span class="dv">2</span>,<span class="dv">1</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>x_0</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1]
[1,]   70
[2,]   16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t</span>(a) <span class="sc">%*%</span> x_0 </span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          [,1]
[1,] -19.57908</code></pre>
</div>
</div>
<p>다시 쓰면</p>
<p><span class="math display">\[
(-0.1002303) \times  (70)  + (-0.7851847) \times  (16)  = -19.5790766
\]</span> 따라서 -19.5790766 &gt; -21.7387617 이므로 그룹 1 (<code>NO</code>) 에 속한다고 판별한다.즉 트랙터를 소유하지 않는 집단에 속한다고 판별한다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t</span>(a) <span class="sc">%*%</span> x_0 <span class="sc">&gt;</span> m</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1]
[1,] TRUE</code></pre>
</div>
</div>
<p>즉, <code>income</code> 과 <code>lotsize</code>가 각각 70, 16 이면 <span class="math inline">\(\pmb a^t \pmb x_0 &gt; m\)</span> 을 만족하므로 트렉터를 소유하지 않을 그룹 (<code>NO</code>) 에 속한다고 판별한다.</p>
<p>트랙터를 소유한 집단과 소유하지 않은 집단에서 소득과 집크기에 대하여 이변량 정규분포를 가정하고 각 집단의 평균벡터와 공통 공분산을 구하여 이변량 정규분포의 확률밀도함수를 이차원 평면에 표시해보았다. 또한 앞에서 구한 선형 판별함수의 경계선 <span class="math inline">\(\pmb a^t \pmb x = m\)</span> 을 표시하였다</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 등고선을 위한 격자점 생성</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>grid <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">income =</span> <span class="fu">seq</span>(<span class="fu">min</span>(df<span class="sc">$</span>income) <span class="sc">-</span> <span class="dv">1</span>, <span class="fu">max</span>(df<span class="sc">$</span>income) <span class="sc">+</span> <span class="dv">1</span>, <span class="at">length =</span> <span class="dv">100</span>),</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">lotsize =</span> <span class="fu">seq</span>(<span class="fu">min</span>(df<span class="sc">$</span>lotsize) <span class="sc">-</span> <span class="dv">1</span>, <span class="fu">max</span>(df<span class="sc">$</span>lotsize) <span class="sc">+</span> <span class="dv">1</span>, <span class="at">length =</span> <span class="dv">100</span>)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 각 집단의 이변량 정규분포 확률밀도함수 계산</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>grid<span class="sc">$</span>dx1 <span class="ot">&lt;-</span> <span class="fu">dmvnorm</span>(grid[,<span class="fu">c</span>(<span class="st">"income"</span>,<span class="st">"lotsize"</span>)], <span class="at">mean =</span> mean_x1, <span class="at">sigma =</span> cov_p)</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>grid<span class="sc">$</span>dx2 <span class="ot">&lt;-</span> <span class="fu">dmvnorm</span>(grid[,<span class="fu">c</span>(<span class="st">"income"</span>,<span class="st">"lotsize"</span>)], <span class="at">mean =</span> mean_x2, <span class="at">sigma =</span> cov_p)</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 산점도와 등고선, 판별 경계선 그리기 </span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>income,<span class="at">y=</span>lotsize, <span class="at">shape=</span>class, <span class="at">color=</span>class)) <span class="sc">+</span> </span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">4</span>, <span class="at">alpha =</span> <span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 평균벡터 표기</span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> mean_vec, <span class="fu">aes</span>(<span class="at">x=</span>income, <span class="at">y=</span>lotsize, <span class="at">color=</span>class),  <span class="at">shape=</span><span class="dv">3</span>, <span class="at">size=</span><span class="dv">5</span>, <span class="at">stroke=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 등고선 1</span></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_contour</span>(</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> grid,</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> income, <span class="at">y =</span> lotsize, <span class="at">z =</span> dx1),</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linewidth =</span> <span class="fl">0.2</span>, <span class="at">bins =</span> <span class="dv">6</span>,</span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">inherit.aes =</span> <span class="cn">FALSE</span></span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 등고선 2</span></span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_contour</span>(</span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> grid,</span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> income, <span class="at">y =</span> lotsize, <span class="at">z =</span> dx2),</span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">linewidth =</span> <span class="fl">0.2</span>, <span class="at">bins =</span> <span class="dv">6</span>,</span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">inherit.aes =</span> <span class="cn">FALSE</span></span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 판별 경계선</span></span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(</span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">intercept =</span> m<span class="sc">/</span>a[<span class="dv">2</span>], <span class="at">slope =</span> <span class="sc">-</span>a[<span class="dv">1</span>]<span class="sc">/</span>a[<span class="dv">2</span>],</span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linewidth =</span> <span class="dv">1</span></span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb31-34"><a href="#cb31-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb31-35"><a href="#cb31-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"가구 소득"</span>,<span class="at">y=</span><span class="st">"집 면적 "</span>,<span class="at">shape=</span><span class="st">"소유 여부"</span>, <span class="at">color =</span> <span class="st">"소유 여부"</span>)</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="multivar-discrim_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>패키지 <code>MAASS</code> 의 함수 <code>lda()</code>을 이용하면 앞에서 구한 Fisher 의 선형판별함수를 쉽게 구할 수 있다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>fisher_model <span class="ot">&lt;-</span> <span class="fu">lda</span>(class <span class="sc">~</span> income <span class="sc">+</span> lotsize, <span class="at">data =</span> df, <span class="at">method=</span><span class="st">"moment"</span>)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>fisher_model</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
lda(class ~ income + lotsize, data = df, method = "moment")

Prior probabilities of groups:
 NO YES 
0.5 0.5 

Group means:
    income  lotsize
NO  57.400 17.63333
YES 79.475 20.26667

Coefficients of linear discriminants:
              LD1
income  0.0484468
lotsize 0.3795228</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 판별 벡터</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>fisher_model<span class="sc">$</span>scaling</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              LD1
income  0.0484468
lotsize 0.3795228</code></pre>
</div>
</div>
<p>참고로 함수 <code>lda</code> 의 결과값인 <code>Coefficients of linear discriminants</code> 는 <a href="#eq-discrim-fisher-optimal" class="quarto-xref">식&nbsp;<span>5.17</span></a> 에서 구한 최적 변환 백터 <span class="math inline">\(\pmb a\)</span> 와 같은 방향의 벡터이지만 길이가 다른 점에 유의하자.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># lda 함수의 결과와 비교</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>a<span class="sc">/</span>a[<span class="dv">1</span>]</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            [,1]
income  1.000000
lotsize 7.833806</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>fisher_model<span class="sc">$</span>scaling<span class="sc">/</span>fisher_model<span class="sc">$</span>scaling[<span class="dv">1</span>]</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             LD1
income  1.000000
lotsize 7.833806</code></pre>
</div>
</div>
<p>이제 위에서 고려한 값, 즉 <code>income</code> 과 <code>lotsize</code>가 각각 70, 16 이라면 다음과 같이 새로운 데이터프레임을 만들고 <code>predict</code> 함수를 사용하여 앞에서 구한 판별 결과와 동일한 결과를 얻을 수 있다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>new_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">income =</span> <span class="dv">70</span>, <span class="at">lotsize =</span> <span class="dv">16</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(fisher_model, <span class="at">newdata =</span> new_data)</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$class
[1] NO
Levels: NO YES

$posterior
         NO       YES
1 0.8965703 0.1034297

$x
        LD1
1 -1.043894</code></pre>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "복사완료!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "복사완료!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../qmd/multivar-cov.html" class="pagination-link" aria-label="공분산 행렬의 추정">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">공분산 행렬의 추정</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../qmd/multivar-pca.html" class="pagination-link" aria-label="주성분 분석">
        <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">주성분 분석</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>